<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>–ì–æ–Ω–∫–∞ –∑–∞ 50 –ø—É–Ω–∫—Ç–æ–≤</title>


<style>
body{
margin:0;
padding:20px;
font-family:system-ui, -apple-system, sans-serif;
background:linear-gradient(135deg,#fde2e4,#e0f2fe);
}


h1{text-align:center}


.players{max-width:520px;margin:0 auto;display:flex;flex-direction:column;gap:16px}


.card{
background:#fff;
border-radius:16px;
padding:12px;
box-shadow:0 4px 10px rgba(0,0,0,.1)
}


.top{display:flex;align-items:center;gap:12px}
.avatar img{width:48px;height:48px;border-radius:50%;object-fit:cover}


.bar{
background:#e5e7eb;
height:14px;
border-radius:8px;
overflow:hidden;
margin:8px 0 10px;
}


.fill{height:100%;background:#4ade80;width:0%;transition:width .4s ease}


.bar.flash-green{box-shadow:0 0 0 3px rgba(34,197,94,.6)}
.bar.flash-red{box-shadow:0 0 0 3px rgba(248,113,113,.7)}


.buttons{display:flex;gap:8px}
button{flex:1;border:none;border-radius:10px;padding:6px;font-size:18px;cursor:pointer}
.plus{background:#22c55e;color:#fff}
.minus{background:#f87171;color:#fff}

/* confetti */
.confetti{
position:fixed;
top:-10px;
width:8px;
height:12px;
opacity:.8;
pointer-events:none;
animation:fall linear forwards;
z-index:9999
}


@keyframes fall{
to{transform:translateY(110vh) rotate(720deg)}
}
</style>
</head>
<body>


<h1>üèÅ –ì–æ–Ω–∫–∞ –∑–∞ 50 –ø—É–Ω–∫—Ç–æ–≤</h1>


<div class="players" id="players"></div>


<script>
const GOAL=50;
const STORAGE_KEY="points_race";


const defaultPlayers=[
{id:1,name:"Luca",points:0,avatar:"luca.png"},
{id:2,name:"Ezra",points:0,avatar:"ezra.png"},
{id:3,name:"Raphael",points:0,avatar:"raphael.png"}
];

let players=load();


function load(){
const s=localStorage.getItem(STORAGE_KEY);
return s?JSON.parse(s):JSON.parse(JSON.stringify(defaultPlayers));
}


function save(){
localStorage.setItem(STORAGE_KEY,JSON.stringify(players));
}


function changePoints(id,delta){
const p=players.find(x=>x.id===id);
if(!p)return;
const old=p.points;
p.points+=delta;
save();
render();
highlight(id,p.points-old);
checkWinner();
}


function highlight(id,diff){
const bar=document.querySelector(`[data-bar='${id}']`);
if(!bar)return;
const cls=diff>=0?"flash-green":"flash-red";
bar.classList.add(cls);
setTimeout(()=>bar.classList.remove(cls),400);
}


function checkWinner(){
const w=players.find(p=>p.points>=GOAL);
if(w){
launchConfetti();
setTimeout(()=>{
alert("üéâ –ü–æ–±–µ–¥–∏—Ç–µ–ª—å: "+w.name);
reset();
},600);
}
}


function reset(){
players=JSON.parse(JSON.stringify(defaultPlayers));
localStorage.removeItem(STORAGE_KEY);
render();
}


function render(){
const root=document.getElementById("players");
root.innerHTML="";


players.forEach(p=>{
const progress=Math.max(0,Math.min(p.points/GOAL,1))*100;

const div=document.createElement("div");
div.className="card";
div.innerHTML=`
<div class="top">
<div class="avatar"><img src="${p.avatar}"></div>
<div><b>${p.name}</b><br>${p.points} –ø—É–Ω–∫—Ç–æ–≤</div>
</div>
<div class="bar" data-bar="${p.id}"><div class="fill" style="width:${progress}%"></div></div>
<div class="buttons">
<button class="plus">+</button>
<button class="minus">‚àí</button>
</div>`;


div.querySelector(".plus").onclick=()=>changePoints(p.id,1);
div.querySelector(".minus").onclick=()=>changePoints(p.id,-1);


root.appendChild(div);
});
}


function launchConfetti(){
const colors=["#ff6b6b","#ffd93d","#6bcb77","#4dabf7","#c77dff"];
for(let i=0;i<120;i++){
const c=document.createElement("div");
c.className="confetti";
c.style.left=Math.random()*100+"vw";
c.style.background=colors[Math.floor(Math.random()*colors.length)];
c.style.animationDuration=2+Math.random()*2+"s";
document.body.appendChild(c);
setTimeout(()=>c.remove(),4000);
}
}


render();
</script>


</body>
</html>
